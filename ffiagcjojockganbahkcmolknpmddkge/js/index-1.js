var hostname,type,address,IsModeratorAvailable,pwdaddress,IsScreenRequesting,IsMirrorRequesting,IsFullScreenRequesting,addrToConnect,localIp,allView={Homepage:"homepage_container",Mainpage:"main_container",DeviceList:"device_list_container",Webview:"webview_container",Setting:"setting_container",Media:"media_container",Split:"split_container",Preference:"prefer_container"},REMOTE_CONTROL_KEY_UP=10,REMOTE_CONTROL_KEY_DOWN=11,REMOTE_CONTROL_KEY_LEFT=12,REMOTE_CONTROL_KEY_RIGHT=13,REMOTE_CONTROL_KEY_ENTER=14,REMOTE_CONTROL_KEY_ESC=15,REMOTE_CONTROL_KEY_BACKSPACE=-1,ESHARE_SWITCH_TO=100,ESHARE_ON=101,ESHARE_OFF=102,DLNA_SWITCH_TO=103,DLNA_ON=104,DLNA_OFF=105,MIRACAST_SWITCH_TO=106,MIRACAST_ON=107,MIRACAST_OFF=108,EPLAY_SWITCH_TO=109,EPLAY_ON=110,EPLAY_OFF=111,QUERY_STATUS=112,MAIN_SWITCH_TO=113,SETTING_SWITCH_TO=114,ES_SPLIT_COUNT=0,ES_SPLIT_POSITION=0,currentAF="web",currentDevice=null,isLoading=!1,EMediaToken=null,GuestPageTitle="",ESClientAppUniqueID=null,ESClientProductID="com.eshare.client",ESClientProProductID="com.eshare.clientpro",CountryCode="US",ES_HOST_MAC="000000000000",ES_SERVER_PORT=80,ES_GA_Tracker=null,ES_GA_Usetime=null,MYuserAgent="Mozilla/5.0 (Linux; U; Android 4.2; EShare Build/KOT49H) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Mobile Safari/537.36/eshare",USER_LOGIN=!0,chromeAccount="chrome",connectHistory=[],ReceiverList=[],chromeDeviceAbnormal=null,ConnectWithIP=!1,RequestCastOrder=JSON.stringify({requestCast:7}),RequestMirrorOrder=JSON.stringify({requestCast:9}),RequestFullScreenOrder=JSON.stringify({requestCast:8}),chromeVersion=chrome.runtime.getManifest().version,invitationTimeOut=!1,IsMirroring=!1,ipconnectBoolean=!1,ipClick=!0,checkIpTimeOut=!1,ConnectWithPIN=!1,cancelPincode=!0,newtime=0,oldtime=0;async function OnReceiverFound(e){navigator.onLine?(UIActionProc.displayLoading(!1,!1),addElement(e)):UIActionProc.displayLoading(!0,!0)}function OnConnectedToProjector(e){ConnectToProjector(e,!0)}function unique(e){var t=new Array;for(var n in e)t[e[n]]=1;var o=new Array;for(var i in t)o.push(i);return o}String.prototype.format=function(e){var t=this;if(arguments.length>0)if(1==arguments.length&&"object"==typeof e){for(var n in e)if(null!=e[n]){var o=new RegExp("({"+n+"})","g");t=t.replace(o,e[n])}}else for(var i=0;i<arguments.length;i++)if(null!=arguments[i]){o=new RegExp("({)"+i+"(})","g");t=t.replace(o,arguments[i])}return t},chrome.system.display.getInfo((function(e){for(var t=0;t<e.length;t++)if(e[t].isPrimary){ScreenDisplayW=e[t].bounds.width,ScreenDisplayH=e[t].bounds.height;break}}));var setinter=setInterval(RefreshDeviceList,1e3);function addElement(e){e.time=(new Date).getTime();let t=!1,n=jQuery("<tr id='table_tr' class='table_tr'><td id='ssidtwo'><p id='ssidtwop1'></p><p id='ssidtwop2'></p></td></td><td id='ssidpassword'></td><td id='ssid'><button id='button_connecttwo' class='button_connecttwo' type='button'></button></td></tr>");if(ReceiverList&&ReceiverList.length>0){for(var o=0;o<ReceiverList.length;o++)if(e.ip===ReceiverList[o].ip){if(t=!0,ReceiverList[o].time=(new Date).getTime(),e.name!=ReceiverList[o].deviceType||e.features!=ReceiverList[o].password){ReceiverList[o].password=e.features,ReceiverList[o].deviceType=e.name;for(var i=0;i<document.getElementsByClassName("table_tr").length;i++)e.ip==$(".list_table tr").eq(i).find("#ssidtwo").find("#ssidtwop2").text()&&($(".list_table tr").eq(i).find("#ssidtwo").find("#ssidtwop1").text(e.name),$(".list_table tr").eq(i).find("#ssidpassword").text(e.features))}break}t||(ReceiverList.push(e),n.find("#ssid").find("#button_connecttwo").text(chrome.i18n.getMessage("connect_immediately")),n.find("#ssidtwo").find("#ssidtwop1").text(e.name),n.find("#ssidtwo").find("#ssidtwop2").text(e.ip),n.find("#ssidpassword").text(e.features),$(".list_table").append(n))}else ReceiverList.push(e),n.find("#ssid").find("#button_connecttwo").text(chrome.i18n.getMessage("connect_immediately")),n.find("#ssidtwo").find("#ssidtwop1").text(e.name),n.find("#ssidtwo").find("#ssidtwop2").text(e.ip),n.find("#ssidpassword").text(e.features),$(".list_table").append(n);n.find("#ssid").find("#button_connecttwo").click((async function(){ConnectWithIP=!1,1==($(this).parent().prev().text()>>20&1)?(IsModeratorAvailable=!0,$("#pinconnect").val(""),"block"==$("#local_ip").css("display")&&($("#local_ip").css("display","none"),$("#local_ip_table").empty()),hostname=$(this).parent().prev().prev().find("#ssidtwop1").text(),type=$(this).parent().prev().prev().find("#ssidtwop1").text(),address=$(this).parent("#ssid").prev().prev().find("#ssidtwop2").html(),pwdaddress=$(this).parent("#ssid").prev().prev().find("#ssidtwop2").html(),$("#p_text").html(""),$("#C_I_name").text(pwdaddress),addrToConnect=address,1==($(this).parent().prev().text()>>6&1)?($("#passwordinput").val(""),$("#passwordPoint").text(" "),$("#myModalLabel").html(chrome.i18n.getMessage("password")),$("#myModalLabel").removeClass("myModalLabelcolor"),$("#myModal").modal().on("shown.bs.modal",(()=>{autofocus()}))):connectDevice(hostname,type,address)):(IsModeratorAvailable=!1,$("#pinconnect").val(""),"block"==$("#local_ip").css("display")&&($("#local_ip").css("display","none"),$("#local_ip_table").empty()),hostname=$(this).parent().prev().prev().find("#ssidtwop1").text(),type=$(this).parent().prev().prev().find("#ssidtwop1").text(),address=$(this).parent("#ssid").prev().prev().find("#ssidtwop2").html(),pwdaddress=$(this).parent("#ssid").prev().prev().find("#ssidtwop2").html(),$("#p_text").html(""),$("#C_I_name").text(pwdaddress),addrToConnect=address,1==($(this).parent().prev().text()>>6&1)?($("#passwordinput").val(""),$("#passwordPoint").text(" "),$("#myModalLabel").html(chrome.i18n.getMessage("password")),$("#myModalLabel").removeClass("myModalLabelcolor"),$("#myModal").modal().on("shown.bs.modal",(()=>{autofocus()}))):connectDevice(hostname,type,address))}))}function jsonUniq(e,t){let n=[e[0]];return e.forEach((function(e,o){let i=!1;n.forEach((function(n,o){e[t]!=n[t]||(i=!0)})),i||n.push(e)})),n}function autofocus(){let e=document.getElementById("passwordinput");e.focus(),e.select()}function pwdbybutton(){if(ipClick)if(cancelPincode=!0,address=$("#pinconnect").val(),hostname=$("#pinconnect").val(),pwdaddress=$("#pinconnect").val(),type=null,ipClick=!1,ipconnectBoolean=!1,checkIpTimeOut=!1,ConnectWithIP=!1,$("#p_text").html(""),""==pwdaddress)$("#ipInput_null").text(chrome.i18n.getMessage("CannotIpNull")),ipClick=!0;else if(pwdaddress.indexOf(".")>0)$("#ipErrordivconnecting").css("display","block"),$("#pinconnect").blur(),ConnectWithPIN=!1,ConnectWithIP=!0,$("#C_I_name").text(pwdaddress),chrome.runtime.sendMessage({action:"connectpasswordthree",pwddwd:"GETPASSWORDCONFIG\r\neshare\r\n\r\n",address:pwdaddress}),setTimeout((function(){ipconnectBoolean||cancelPincode&&($("#ipErrordivconnecting").css("display","none"),$("#ipErrordiv").css("display","block"),$("#pinconnect").blur(),$("#pwdbybutton").css("pointer-events","none"),$("#ssid #button_connecttwo").css("pointer-events","none"),$("#pwdbybutton").css("background-image","url(/images/ic_landing_normal@3x.png)"),checkIpTimeOut=!0),ipClick=!0}),3e3);else if(8==pwdaddress.length)$("#ipErrordivconnecting").css("display","block"),$("#pinconnect").blur(),ConnectWithPIN=!0,pwdaddress=GetAddr_8C(pwdaddress),address=pwdaddress,$("#C_I_name").text(pwdaddress),chrome.runtime.sendMessage({action:"connectpasswordthree",pwddwd:"GETPASSWORDCONFIG\r\neshare\r\n\r\n",address:pwdaddress}),setTimeout((function(){ipconnectBoolean||cancelPincode&&($("#ipErrordivconnecting").css("display","none"),$("#ipErrordiv").css("display","block"),$("#pinconnect").blur(),$("#pwdbybutton").css("pointer-events","none"),$("#ssid #button_connecttwo").css("pointer-events","none"),$("#pwdbybutton").css("background-image","url(/images/ic_landing_normal@3x.png)"),checkIpTimeOut=!0),ipClick=!0}),3e3);else if(6==pwdaddress.length){$("#ipErrordivconnecting").css("display","block"),$("#pinconnect").blur(),IsModeratorAvailable=!0,ConnectWithPIN=!0,pwdaddress=GetAddr_6D(pwdaddress),address=pwdaddress;let e=localIp.substring(0,localIp.lastIndexOf(".")+1)+"1";$("#C_I_name").text(pwdaddress),chrome.runtime.sendMessage({action:"connectpasswordthree",pwddwd:"GETPASSWORDCONFIG\r\neshare\r\n\r\n",address:pwdaddress}),setTimeout((function(){ipconnectBoolean||localIp===e?!ipconnectBoolean&&cancelPincode?($("#ipErrordivconnecting").css("display","none"),$("#ipErrordiv").css("display","block"),$("#pinconnect").blur(),$("#pwdbybutton").css("pointer-events","none"),$("#ssid #button_connecttwo").css("pointer-events","none"),$("#pwdbybutton").css("background-image","url(/images/ic_landing_normal@3x.png)"),checkIpTimeOut=!0,ipClick=!0):ipClick=!0:(address=pwdaddress=e,$("#C_I_name").text(pwdaddress),chrome.runtime.sendMessage({action:"connectpasswordthree",pwddwd:"GETPASSWORDCONFIG\r\neshare\r\n\r\n",address:pwdaddress}),setTimeout((function(){!ipconnectBoolean&&cancelPincode&&($("#ipErrordivconnecting").css("display","none"),$("#ipErrordiv").css("display","block"),$("#pinconnect").blur(),$("#pwdbybutton").css("pointer-events","none"),$("#ssid #button_connecttwo").css("pointer-events","none"),$("#pwdbybutton").css("background-image","url(/images/ic_landing_normal@3x.png)"),checkIpTimeOut=!0),ipClick=!0}),3e3))}),3e3)}else $("#ipErrordivconnecting").css("display","block"),$("#pinconnect").blur(),ConnectWithPIN=!1,setTimeout((function(){ipconnectBoolean||cancelPincode&&($("#ipErrordivconnecting").css("display","none"),$("#ipErrordiv").css("display","block"),$("#pinconnect").blur(),$("#pwdbybutton").css("pointer-events","none"),$("#ssid #button_connecttwo").css("pointer-events","none"),$("#pwdbybutton").css("background-image","url(/images/ic_landing_normal@3x.png)"),checkIpTimeOut=!0),ipClick=!0}),100)}function GetAddr_8C(e){var t=e,n=stringPin(t[0])*Math.pow(26,7)+stringPin(t[1])*Math.pow(26,6)+stringPin(t[2])*Math.pow(26,5)+stringPin(t[3])*Math.pow(26,4)+stringPin(t[4])*Math.pow(26,3)+stringPin(t[5])*Math.pow(26,2)+stringPin(t[6])*Math.pow(26,1)+stringPin(t[7])*Math.pow(26,0),o=(Math.pow(26,8)-1-n)%Math.pow(256,4);return parseInt(o/Math.pow(256,3))+"."+parseInt(o%Math.pow(256,3)/Math.pow(256,2))+"."+parseInt(o%Math.pow(256,2)/Math.pow(256,1))+"."+parseInt(o%256)}function stringPin(e){switch(e.toUpperCase()){case"A":return 0;case"B":return 1;case"C":return 2;case"D":return 3;case"E":return 4;case"F":return 5;case"G":return 6;case"H":return 7;case"I":return 8;case"J":return 9;case"K":return 10;case"L":return 11;case"M":return 12;case"N":return 13;case"O":return 14;case"P":return 15;case"Q":return 16;case"R":return 17;case"S":return 18;case"T":return 19;case"U":return 20;case"V":return 21;case"W":return 22;case"X":return 23;case"Y":return 24;case"Z":return 25}}function DeviceListRefresh(e){$(".header").html(chrome.i18n.getMessage("connectdevice")),$("#pinconnect").attr("placeholder",chrome.i18n.getMessage("placeholder")),$("#buttonChromeAccount").html(chrome.i18n.getMessage("Determine")),UIActionProc.displayLoading(!0,!1),$("#device_name_headerb").text(chrome.i18n.getMessage("Modify_the_name")),$("#device_name_b").html(chrome.i18n.getMessage("Null_name")),$("#device_name_wide_alert").html(chrome.i18n.getMessage("Wide_alert")),$("#device_name_button").html(chrome.i18n.getMessage("Submit")),$("#device_name_cancel").html(chrome.i18n.getMessage("cancel")),$("#ResolvingPowerp").html(chrome.i18n.getMessage("ConnectAgain")),$("#CloseResolvingPower").html(chrome.i18n.getMessage("CloseConnectAgain")),$("#heChromeAccount h4").html(chrome.i18n.getMessage("DevicesName")),$("#heChromeAccount p").html(chrome.i18n.getMessage("DevicesNameDisplay")),$("#account_button_cancel").html(chrome.i18n.getMessage("cancel")),$("#about_header span").html(chrome.i18n.getMessage("about")),$("#about_version_update").html(chrome.i18n.getMessage("VersionUpdate")),$("#about_version_info p:nth-child(1) span:nth-child(1)").html(chrome.i18n.getMessage("Privacy")),$("#about_version_info p:nth-child(1) span:nth-child(2)").html(chrome.i18n.getMessage("ServiceAgreement")),$("#about_version_info p:nth-child(2)").html(chrome.i18n.getMessage("Eshare")),$("#div_home_text").html(chrome.i18n.getMessage("Disconnect")),$("#div_fullscreen_text").html(chrome.i18n.getMessage("FullScreen")),$("#mci_header").html(chrome.i18n.getMessage("MainControl")),$("#setting_info_connect_ui li:nth-child(1)").html(chrome.i18n.getMessage("DevicesName")),$("#setting_info_connect_ui li:nth-child(2)").html(chrome.i18n.getMessage("ScreenGuide")),$("#setting_info_connect_ui li:nth-child(4)").html(chrome.i18n.getMessage("about")),$("#Cyes").html(chrome.i18n.getMessage("Determine")),$("#Ccancel").html(chrome.i18n.getMessage("cancel")),$("#ipErrordiv p").text(chrome.i18n.getMessage("ConnectIpError")),$("#iperrorconnecting_p").text(chrome.i18n.getMessage("Ipconnect")),$("#cancelIpConnect").text(chrome.i18n.getMessage("cancel")),$("#ipErrordiv a").text(chrome.i18n.getMessage("PleaseRepeat")),chrome.runtime.sendMessage({action:"discovery",IP:e})}function languagefind(){"ru"==window.navigator.language.slice(0,2)?($("#about_version_update").css({width:"120px","font-size":"9px"}),$("#div_fullscreen_text").css("width","100px")):($("#about_version_update").css({width:"100px","font-size":"11px"}),$("#div_fullscreen_text").css("width","100px"))}function RefreshDeviceList(e){chrome.system.network.getNetworkInterfaces((function(e){if(0!=e.length)for(var t=0;t<e.length;t++)24==e[t].prefixLength&&(localIp!=e[t].address&&(localIp=e[t].address),$("#localAddress").html(localIp))})),chrome.runtime.sendMessage({action:"discovery",IP:e})}function ConnectToProjector(e,t){setinter&&(clearInterval(setinter),setinter=null),trackEvent("Connect","Device",e.Hostname),currentDevice=e,t&&SetPreferDevice(!0,e.ID,e.Hostname),$("div#connectDialog").modal("hide");var n=e.Name?e.Name:e.Hostname;$("#CurrConnDevice").html(n);var o=e.Hostname;void 0!==e.Name&&(o=e.Name),chrome.storage.local.get("role",(function(e){if($("#dongleName").html(o),e&&e.role){var t="";"ESHAREPRO"===chrome.runtime.getManifest().product.toUpperCase()&&(t="host"===e.role?"(Host) ":"(Guest) "),$("#dongleName").html(t+o)}ShowMainpage(),SendRCKey(ESHARE_SWITCH_TO)}))}function connect(){let e=$(".listtt").find("#ssid").html(),t=$(".listtt").val(),n=$(".listtt").find("#ip").html();$(".listtt").hasClass("NeedPWD")?($("div#myModal").modal(),$("#myModalLabel").html(chrome.i18n.getMessage("password")),$("#myModalLabel").removeClass("myModalLabelcolor"),$("#passwordinput").val("")):connectDevice(e,t,n)}function connectDevice(e,t,n){chromeDeviceAbnormal=setInterval((function(){newtime=(new Date).getTime(),0!=oldtime&&newtime-oldtime>4e3&&$("#div_home").click()}),1e3),$("#main_container").css("display","block"),chrome.runtime.sendMessage({action:"connectToDevice",ssid:e,deviceType:t,ip:n}),chrome.runtime.sendMessage({action:"getIpConnectName",getServerInfo:"getFeatures\r\nchrome-common\r\n\r\ngetServerInfo\r\nchrome-common\r\n\r\n",address:n})}function connectbypw(){$("#passwordPoint").text(" ");var e=$("#passwordinput").val();""==e?$("#passwordPoint").text(chrome.i18n.getMessage("CannotIpNull")):(addrToConnect=address=pwdaddress,pwdaddress?chrome.runtime.sendMessage({action:"connectpassword",pwdd:e.toUpperCase(),address:address}):($("#myModalLabel").html(chrome.i18n.getMessage("passworderror")),$("#myModalLabel").addClass("myModalLabelcolor")))}function GetAddr_6D(e){var t=999999-e,n=parseInt(t%Math.pow(256,2)/256),o=t%256;return localIp.split(".")[0]+"."+localIp.split(".")[1]+"."+n+"."+o}setInterval((function(){null!=setinter&&(ReceiverList.forEach((async(e,t)=>{if((new Date).getTime()-e.time>1e4)for(var n=0;n<document.getElementsByClassName("table_tr").length;n++)e.ip==$(".list_table tr").eq(n).find("#ssidtwo").find("#ssidtwop2").text()&&(ReceiverList.splice(t,1),await $(".list_table tr").eq(n).remove())})),(0==$("#taotable table").children().length||0==$("#taotable table tbody").children().length)&&UIActionProc.displayLoading(!0,!1))}),3e3),window.addEventListener("online",(function(e){setinter&&clearInterval(setinter),$("#loading_text").css("color","black"),setinter=setInterval(RefreshDeviceList,1e3)})),window.addEventListener("offline",(function(e){setinter&&(clearInterval(setinter),setinter=null),$("#device_list_container").hasClass("viewHide")&&$("#device_list_container").removeClass("viewHide"),UIActionProc.displayLoading(!0,!0)}));var digits="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function Pinconputer(e,t){for(var n=0,o=e,i=0;i<e.length;i++)for(var r=0;r<digits.length;r++)if(digits[r]==o[i]){n+=r*Math.pow(t,e.length-i-1);break}return n}function mirrorbefore(){IsScreenRequesting=!0,IsMirrorRequesting=!1,IsFullScreenRequesting=!1;var e=RequestCastOrder.toString();chrome.runtime.sendMessage({action:"mirrorBefore",RequestContent:e})}function sendFullScreen(){IsMirrorRequesting=!1,IsScreenRequesting=!1,IsFullScreenRequesting=!0;var e=RequestFullScreenOrder.toString();chrome.runtime.sendMessage({action:"mirrorBefore",RequestContent:e})}function mirrorRequest(){IsMirrorRequesting=!0,IsScreenRequesting=!1,IsFullScreenRequesting=!1;var e=RequestMirrorOrder.toString();chrome.runtime.sendMessage({action:"mirrorBefore",RequestContent:e})}function WebviewInit(){doWebviewLayout();var e=document.querySelector("#amWebview");if(e.setUserAgentOverride(MYuserAgent),e.addEventListener("newwindow",(function(e){e.preventDefault(),processLocation(e.targetUrl)})),chrome.runtime.onMessage.addListener((function(e,t,n){if(e.detail){var o=e.detail;if(o.function&&("MagicBoardAppProxy.endMagicBoard"===o.function&&ShowMainpage("Board ended by host"),"MagicBoardAppProxy.handleAppRoleChanged"===o.function)){document.querySelector("#amWebview").executeScript({code:"var detail = {role:'' + detail.role + ''};var customEvent = new CustomEvent('MagicBoardAppProxy.handleAppRoleChanged', {'detail':detail});window.dispatchEvent(customEvent);"})}}})),document.querySelector("#back").onclick=function(){e.back()},document.querySelector("#forward").onclick=function(){e.forward()},document.querySelector("#home").onclick=function(){getHomeUrl((function(e){navigateTo(e)}))},document.querySelector("#reload").onclick=function(){isLoading?e.stop():e.reload()},document.querySelector("#reload").addEventListener("webkitAnimationIteration",(function(){isLoading||document.body.classList.remove("loading")})),document.querySelector("#bookmark").onclick=function(){addBookmark()},document.querySelector("#location-form").onsubmit=function(e){e.preventDefault(),processLocation(document.querySelector("#location").value)},e.addEventListener("exit",handleExit),e.addEventListener("loadstart",handleLoadStart),e.addEventListener("loadstop",handleLoadStop),e.addEventListener("loadabort",handleLoadAbort),e.addEventListener("loadredirect",handleLoadRedirect),e.addEventListener("loadcommit",handleLoadCommit),e.addEventListener("contentload",handleContentLoad),"function"==typeof e.setZoom&&"function"==typeof e.find){var t=!1;document.querySelector("#zoom-form").onsubmit=function(t){t.preventDefault();var n=document.forms["zoom-form"]["zoom-text"],o=Number(n.value);o>5?(n.value="5",o=5):o<.25&&(n.value="0.25",o=.25),e.setZoom(o)},document.querySelector("#zoom-in").onclick=function(e){e.preventDefault(),increaseZoom()},document.querySelector("#zoom-out").onclick=function(e){e.preventDefault(),decreaseZoom()},document.querySelector("#find-text").oninput=function(n){e.find(document.forms["find-form"]["find-text"].value,{matchCase:t})},document.querySelector("#find-text").onkeydown=function(t){event.ctrlKey&&13==event.keyCode&&(t.preventDefault(),e.stopFinding("activate"),closeFindBox())},document.querySelector("#match-case").onclick=function(n){n.preventDefault(),t=!t;var o=document.querySelector("#match-case");t?(o.style.color="blue",o.style["font-weight"]="bold"):(o.style.color="black",o.style["font-weight"]=""),e.find(document.forms["find-form"]["find-text"].value,{matchCase:t})},document.querySelector("#find-backward").onclick=function(n){n.preventDefault(),e.find(document.forms["find-form"]["find-text"].value,{backward:!0,matchCase:t})},document.querySelector("#find-form").onsubmit=function(n){n.preventDefault(),e.find(document.forms["find-form"]["find-text"].value,{matchCase:t})},e.addEventListener("findupdate",handleFindUpdate),window.addEventListener("keydown",handleKeyDown)}else{var n=document.querySelector("#zoom");n&&n.style&&(n.style.visibility="hidden",n.style.position="absolute");var o=document.querySelector("#find");o&&o.style&&(o.style.visibility="hidden",o.style.position="absolute")}}function navigateTo(e){resetExitedState(),document.querySelector("#amWebview").src=e}function doWebviewLayout(){if(chrome.app.window.get("ESClientMain")){document.querySelector("#amWebview"),document.querySelector("#webview_controls");getModeUrlScheme((function(e){var t=!1;""!==e&&(t=!0),$("#webview_controls").hasClass("backOnly")&&!t?($("#back").addClass("viewHide"),$("#forward").addClass("viewHide"),$("#home").addClass("viewHide"),$("#reload").addClass("viewHide"),$("#bookmark").addClass("viewHide"),$("#toMedia").addClass("viewHide"),$("#center-column").addClass("viewHide")):($("#back").removeClass("viewHide"),$("#forward").removeClass("viewHide"),$("#home").removeClass("viewHide"),$("#reload").removeClass("viewHide"),$("#bookmark").removeClass("viewHide"),$("#toMedia").removeClass("viewHide"),$("#center-column").removeClass("viewHide"))}));chrome.app.window.get("ESClientMain").innerBounds.width,chrome.app.window.get("ESClientMain").innerBounds.height}}function handleExit(e){document.body.classList.add("exited"),"exeception"==e.type?document.body.classList.add("crashed"):"killed"==e.type&&document.body.classList.add("killed")}function resetExitedState(){document.body.classList.remove("exited"),document.body.classList.remove("crashed"),document.body.classList.remove("killed")}function handleFindUpdate(e){var t=document.querySelector("#find-results");if(""===e.searchText?t.innerText="":t.innerText=e.activeMatchOrdinal+" of "+e.numberOfMatches,e.finalUpdate&&!e.canceled){var n=document.querySelector("#find-box");n.style.left="",n.style.opacity="";var o=n.getBoundingClientRect();if(findBoxObscuresActiveMatch(o,e.selectionRect)){var i=e.selectionRect.left-o.width-10;i>=5?n.style.left=i+"px":n.style.opacity="0.5"}}}function findBoxObscuresActiveMatch(e,t){return e.left<t.left+t.width&&e.right>t.left&&e.top<t.top+t.height&&e.bottom>t.top}function handleKeyDown(e){if(!$("#"+allView.Webview).hasClass("viewHide")&&e.ctrlKey)switch(e.keyCode){case 70:e.preventDefault(),"block"==document.querySelector("#find-box").style.display?(document.querySelector("#amWebview").stopFinding(),closeFindBox()):openFindBox();break;case 107:case 187:e.preventDefault(),increaseZoom();break;case 109:case 189:e.preventDefault(),decreaseZoom()}}function handleLoadCommit(e){if(resetExitedState(),e.isTopLevel){document.querySelector("#location").value=e.url;var t=document.querySelector("#amWebview");document.querySelector("#back").disabled=!t.canGoBack(),document.querySelector("#forward").disabled=!t.canGoForward(),closeBoxes()}}function handleLoadStart(e){document.body.classList.add("loading"),isLoading=!0,resetExitedState(),e.isTopLevel&&(document.querySelector("#location").value=e.url)}function processLocation(e){/^(https?:\/\/)?([\da-z\.-]+)\.([\da-z]{2,6}).*$/i.test(e)?navigateTo(/^(https?:\/\/)/i.test(e)?e:"http://"+e):navigateTo(("cloudvideo"===currentAF?"http://www.google.com/search?tbm=vid&q=":"http://www.google.com/m?q=")+e)}function processScheme(e){if(/eshare:\/\/eshare.app\/back/i.test(e)){var t=document.querySelector("#amWebview");document.getElementById("webview_container").removeChild(t),ShowMainpage()}else if(/eshare:\/\/eshare.app\/download/i.test(e)){var n=e.split("url=");if(n.length>1)decodeURIComponent(n[1])}else/emedia:\/\/eshare.app\/add/i.test(e)}function handleLoadStop(e){isLoading=!1,injectScriptParams()}function handleLoadAbort(e){processScheme(e.url)}function handleLoadRedirect(e){resetExitedState(),e.isTopLevel&&(document.querySelector("#location").value=e.newUrl)}function handleContentLoad(){var e=document.querySelector("#amWebview");e.executeScript({code:"window.addEventListener('message', function(e){   if(e.data.command == 'getTitle'){    e.source.postMessage({ title: document.title }, e.origin);  }});"}),e.contentWindow.postMessage({command:"getTitle"},"*")}function getNextPresetZoom(e){for(var t,n=[.25,.33,.5,.67,.75,.9,1,1.1,1.25,1.5,1.75,2,2.5,3,4,5],o=0,i=n.length-1;i-o>1;)if(n[t=Math.floor((i+o)/2)]<e)o=t;else{if(!(n[t]>e))return{low:n[t-1],high:n[t+1]};i=t}return{low:n[o],high:n[i]}}function increaseZoom(){var e=document.querySelector("#amWebview");e.getZoom((function(t){var n=getNextPresetZoom(t).high;e.setZoom(n),document.forms["zoom-form"]["zoom-text"].value=n.toString()}))}function decreaseZoom(){var e=document.querySelector("#amWebview");e.getZoom((function(t){var n=getNextPresetZoom(t).low;e.setZoom(n),document.forms["zoom-form"]["zoom-text"].value=n.toString()}))}function openZoomBox(){document.querySelector("#amWebview").getZoom((function(e){var t=document.forms["zoom-form"]["zoom-text"];t.value=Number(e.toFixed(6)).toString(),document.querySelector("#zoom-box").style.display="-webkit-flex",t.select()}))}function closeZoomBox(){document.querySelector("#zoom-box").style.display="none"}function openFindBox(){document.querySelector("#find-box").style.display="block",document.forms["find-form"]["find-text"].select()}function closeFindBox(){var e=document.querySelector("#find-box");e.style.display="none",e.style.left="",e.style.opacity="",document.querySelector("#find-results").innerText=""}function closeBoxes(){closeZoomBox(),closeFindBox()}function getHomeUrl(e){var t,n="";currentDevice&&(t="&type=null",currentDevice.Family&&(t="&type="+currentDevice.Family),currentDevice.Type&&("music"!==currentDevice.Type&&"lite"!==currentDevice.Type&&"car"!==currentDevice.Type||(t="&type=eshare"+currentDevice.Type)),n+=t,currentDevice.Hostname&&(n+="&ac="+encodeURIComponent(currentDevice.Hostname)),currentDevice.ID&&(n+="&da="+currentDevice.ID)),getModeUrlScheme((function(t){var o="";t&&(o=t);var i="https://"+o+"url.com/"+"webdefault.php?&tt=tb"+n;i+="&af="+currentAF,i+="&aa="+ES_HOST_MAC,i+="&av="+chrome.runtime.getManifest().version,i+="&app="+ESClientAppUniqueID,i+="&os=cros",i+="&al="+CountryCode,i+="&l="+chrome.i18n.getUILanguage(),md5_vm_test()&&(i+="&checksum="+hex_md5(currentDevice.ID+"\tbind")),e(i)}))}function getEMediaUrl(e){appendSchemeUrl("https://url.com",(function(t){e(t)}))}function getModeUrlScheme(e){chrome.storage.local.get("urlscheme",(function(t){e(t.urlscheme)}))}function appendSchemeUrl(e,t){getModeUrlScheme((function(n){var o=[e.slice(0,8),n,e.slice(8)].join("");t(o)}))}function injectScriptParams(){var e=document.querySelector("#amWebview");e.executeScript({file:"/jsbridge/jsContentScript.js"});var t=aiurJs+jsHandlerJs+bridgeJs+bridgeHandlerJs+webContentJs+("ES_INTERNAL_SERVER_URL='http://127.0.0.1:'"+ES_SERVER_PORT+"/service")+proxyJs;e.executeScript({code:generateScriptText(t)})}function playVisJS(e,t,n,o){document.querySelector("#amWebview").executeScript({code:"window[NAMESPACE]['background']['playlist'].play('' + src + '','' + title + '','' + image + '','' + type + '');"})}function addToEMedia(){}function addBookmark(){chrome.storage.local.get("ugcToken",(function(e){var t="https://url.com";t=(t=(t=t+"&app_id="+ES_HOST_MAC)+"&name="+encodeURIComponent(GuestPageTitle))+"&link="+encodeURIComponent(document.querySelector("#location").value),e&&e.ugcToken&&(t=t+"&token="+e.ugcToken),appendSchemeUrl(t=t+"&category="+("cloudvideo"===currentAF?"2":"1"),(function(e){try{var t=null;(t=new XMLHttpRequest).open("GET",e,!0),t.onreadystatechange=function(){4==t.readyState&&showMessageDlg("Bookmark Success")},t.send(null)}catch(e){}}))}))}var UIActionProc={};function setBtnMirror(e){setbtn_eshare(e,!0,!0)}function showMessageDlg(e){$("#message_content").html(e),$("div#messageDialog").modal()}function SwitchView(e){for(var t in trackView(e),allView)$("#"+allView[t]).addClass("viewHide"),allView[t]===e&&$("#"+allView[t]).removeClass("viewHide")}function ShowHomepage(e){CloseAllDialogs(),SwitchView(allView.Homepage),e&&showMessageDlg(e)}function ShowDeviceList(e){CloseAllDialogs(),SwitchView(allView.DeviceList),DeviceListRefresh(e)}function ShowWebview(e){var t=document.getElementById("webview_container"),n=document.createElement("webview");n.setAttribute("id","amWebview"),t.appendChild(n),e?$("#webview_controls").addClass("backOnly"):$("#webview_controls").removeClass("backOnly"),WebviewInit(),SwitchView(allView.Webview)}function ShowMedia(){SwitchView(allView.Media)}function ShowSplit(){SwitchView(allView.Split),OnNotifyPosition(ES_SPLIT_COUNT,ES_SPLIT_POSITION)}function ShowPrefer(){SwitchView(allView.Preference),RefreshPreference()}function ShowSetting(){chrome.runtime.sendMessage({action:"mediaStop"}),chrome.runtime.sendMessage({action:"stopMirror"}),SwitchView(allView.Setting)}function ShowAirSetup(){chrome.runtime.sendMessage({action:"mediaStop"}),chrome.runtime.sendMessage({action:"stopMirror"}),ShowWebview(),navigateTo(currentDevice.Webroot+"websetting.html")}function ShowMainpage(){SwitchView(allView.Mainpage),$("#ipInput_null").text("")}function CloseAllDialogs(){$("div#pleaseWaitDialog").modal("hide"),$("div#connectDialog").modal("hide"),showGuestRequestDialog(!1,""),showWaitHostDialog(!1),showDeniedRequestDialog(!1,"")}function hasClass(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>-1}function SendRCKey(e){chrome.runtime.sendMessage({action:"sendRCKey",data:e})}function SendRCVendorKey(e){chrome.runtime.sendMessage({action:"sendRCVendorKey",data:e})}function getRandomToken(){var e=new Uint8Array(6);crypto.getRandomValues(e);for(var t="",n=0;n<e.length;++n)t+=e[n].toString(16);return t}function getUserID(){chrome.storage.local.get("userid",(function(e){var t=e.userid;function n(e){chrome.runtime.sendMessage({action:"setUserID",id:e})}t?n(t):(t=getRandomToken(),chrome.storage.local.set({userid:t},(function(){n(t)})))}))}function trackEvent(e,t,n){ES_GA_Tracker&&ES_GA_Tracker.sendEvent(e,t,n)}function trackView(e){ES_GA_Tracker&&ES_GA_Tracker.sendAppView(e)}function getQuality(e,t){chrome.storage.local.get("mirrorQuality",(function(n){setBtnQuality(n.mirrorQuality,e,t),initQualitySwitch(n.mirrorQuality),chrome.runtime.sendMessage({action:"setQuality",quality:"high"})}))}function initQualitySwitch(e){"low"===e&&document.getElementById("quality_switch").click()}function setBtnQuality(e,t,n){n?$("#btnQuality").show():$("#btnQuality").hide(),t?$("#btnQuality").removeClass("disable"):(e="high",$("#btnQuality").addClass("disable")),"low"===e?$("#btnQuality").addClass("active"):$("#btnQuality").removeClass("active")}function setbtn_eshare(e,t,n){getQuality(!0,n),n?($("#btn_eshare").show(),$("#btn_Reverse_share").show()):($("#btn_eshare").hide(),$("#btn_Reverse_share").hide()),t?$("#btn_eshare").removeClass("disable"):$("#btn_eshare").addClass("disable"),e?($("#btn_eshare").addClass("mirror"),$("#btn_eshare").css("display","none"),$("#btn_eshare_two").css("display","block"),$("#btn_eshare.mirror>span").html(chrome.i18n.getMessage("stop_mirroring")),$("#btn_Reverse_share").css("display","none"),$("#btn_eshare").css("float","none"),$("#btn_eshare_two").css("float","none"),$(".div_show").text(chrome.i18n.getMessage("ScreenIsShare"))):($("#btn_eshare").removeClass("mirror"),$("#btn_eshare").css("display","block"),$("#btn_eshare_two").css("display","none"),$("#btn_eshare>span").html(chrome.i18n.getMessage("start_mirroring")),$("#btn_Reverse_share").css("display","block"),$("#btn_eshare").css("float","left"),$("#btn_eshare_two").css("float","left"),$("#div_home_image").css("display","none"),$("#div_fullscreen_photo").css("background-image","url(/imgMainControl/ic_main_control_screen_full_pressed@3x.png)"),$("#btn_eshare_two_suspend").removeClass("continue"),$("#btn_eshare_two_suspend").css("background-image","url(/imagesAccount/ic_share_pause_normal@3x.png)"),$(".div_show").text(chrome.i18n.getMessage("Screenzhunbei")),$("#btn_Reverse_share>span").html(chrome.i18n.getMessage("tv_mirror")),$(".header").html(chrome.i18n.getMessage("connectdevice")),$("#table_trtdone").html(chrome.i18n.getMessage("device_name")),$("#table_trtdtwo").html(chrome.i18n.getMessage("adress_ip")),$("#button_id").html(chrome.i18n.getMessage("connect_immediately")),$("#P_device").html(chrome.i18n.getMessage("already_connect_device")),$("#network_name").css("display","none"),setTimeout((function(){if($(".list_table").find("tr").hasClass("table_tr"))return!1;$("#loading").empty(),$("#loading").addClass("loading_background")}),4100),chrome.app.window.current().restore())}function MainPageInit(){$("#btn_eshare.mirror>span").html(chrome.i18n.getMessage("stop_mirroring")),$("#btn_web>span").html(chrome.i18n.getMessage("web")),$("#btn_emedia>span").html(chrome.i18n.getMessage("emedia")),$("#btn_magicboard>span").html(chrome.i18n.getMessage("magicboard")),$("#btn_cloud_video>span").html(chrome.i18n.getMessage("cloud_video")),$("#btn_split_screen>span").html(chrome.i18n.getMessage("split_screen")),$("#btn_preference>span").html(chrome.i18n.getMessage("preference")),$("#btn_advanced>span").html(chrome.i18n.getMessage("advanced")),$("#btn_comment>span").html(chrome.i18n.getMessage("comment")),$("#btn_setting>span").html(chrome.i18n.getMessage("setting")),$("#btn_airsetup>span").html(chrome.i18n.getMessage("setting")),$("#myModalLabel").html(chrome.i18n.getMessage("password")),$("#passwordbutton").html(chrome.i18n.getMessage("Submit")),$("#passwordbuttoncancel").html(chrome.i18n.getMessage("cancel")),$("#ipNotPro_check").html(chrome.i18n.getMessage("Determine")),$("#myModalLabel").removeClass("myModalLabelcolor"),setupLoginUI(),setupOfflineMode()}function setupLoginUI(){USER_LOGIN?$("#user_acc_div").removeClass("viewHide"):$("#user_acc_div").addClass("viewHide")}function setupOfflineMode(){updateUIbyServiceImp()}function updateUIbyService(e){$("#main_container").removeClass("offline_mode"),updateUIbyServiceImp(e)}function updateUIbyServiceImp(e){var t={};for(var n in t="ESHAREPRO"===chrome.runtime.getManifest().product.toUpperCase()?{web:"enable",cloud_video:"enable",split_screen:"enable",comment:"enable",eshare:"enable",preference:"enable",advanced:"enable",bookmark:"enable"}:{web:"enable",setting:"enable",cloud_video:"enable",comment:"enable",eshare:"enable",bookmark:"enable"})$("#btn_"+n).removeClass("enable disable"),$("#btn_"+n).hide();for(var n in $.isEmptyObject(e)&&(e=t),e)$("#btn_"+n).removeClass("enable disable"),$("#btn_"+n).addClass(e[n]),"disable"!==e[n]&&$("#btn_"+n).show(),"eshare"===n&&setbtn_eshare($("#btn_eshare").hasClass("mirror")&&"enable"===e[n],"enable"===e[n],void 0!==e.eshare),"magicboard"===n&&chrome.runtime.sendMessage({uiAction:"updateEzBoardButton",show:e[n]})}function confirmCastCode(e){$("div#castcodeDialog").modal("hide");var t=$("#castcode").val();currentDevice.passcode===t?($("div#castcodeDialog").addClass("allow"),$("#castcode").val(""),chrome.runtime.sendMessage(e)):showMessageDlg("invalid castcode")}function OnNotifyPosition(e,t){var n=[{btnid:"#split1"},{btnid:"#split2"},{btnid:"#split3"},{btnid:"#split4"},{btnid:"#splitL"},{btnid:"#splitR"},{btnid:"#splitFull"}];for(var o in n)$(n[o].btnid).removeClass("active");4==e&&1==t&&$("#split1").addClass("active"),4==e&&2==t&&$("#split2").addClass("active"),4==e&&3==t&&$("#split3").addClass("active"),4==e&&4==t&&$("#split4").addClass("active"),2==e&&1==t&&$("#splitL").addClass("active"),2==e&&2==t&&$("#splitR").addClass("active"),1==e&&1==t&&$("#splitFull").addClass("active")}function RefreshPreference(){document.getElementById("CurrentDevice").innerHTML=currentDevice.Name,chrome.storage.local.get("UsePrefer",(function(e){e.UsePrefer&&(document.getElementById("CheckUsePrefer").checked=e.UsePrefer),SetPreferInfo(document.getElementById("CheckUsePrefer").checked)})),chrome.storage.local.get("NoDisturb",(function(e){e.NoDisturb&&(document.getElementById("CheckNoDisturb").checked=e.NoDisturb),ChkDoNotDisturb()})),chrome.storage.local.get("AutoAllow",(function(e){e.AutoAllow&&(document.getElementById("CheckAllowRequest").checked=e.AutoAllow),ChkAutoAllow()}))}function SetPreferInfo(e){document.getElementById("DeviceInfo").innerHTML=e?"<div id='PreferDeviceInfo' class='ui-widget-content ui-corner-all'>' + currentDevice.Name + '</div>":""}function ChkUsePrefer(){var e=document.getElementById("CheckUsePrefer").checked;SetPreferDevice(e,currentDevice.ID,currentDevice.Hostname),SetPreferInfo(e)}function ChkDoNotDisturb(){var e=document.getElementById("CheckNoDisturb").checked;document.getElementById("CheckAllowRequest").disabled=e,chrome.storage.local.set({NoDisturb:e}),chrome.runtime.sendMessage({action:"SetNoDisturb",value:e})}function ChkAutoAllow(){var e=document.getElementById("CheckAllowRequest").checked;chrome.storage.local.set({AutoAllow:e}),chrome.runtime.sendMessage({action:"SetAutoAllow",value:e})}function SetPreferDevice(e,t,n){chrome.storage.local.set({UsePrefer:e,preferDeviceID:t,preferDeviceName:n}),chrome.runtime.sendMessage({action:"SetUsePrefer",value:e})}function PreferenceInit(){$("#lblCurrDevice").html(chrome.i18n.getMessage("currentDevice")),$("#lblPreferDevice").html(chrome.i18n.getMessage("preferredDevice")),$("#lblUsePreferredDevice").html(chrome.i18n.getMessage("usePreferredDevice")),$("#lblHostControl").html(chrome.i18n.getMessage("hostcontrol")),$("#lblDND").html(chrome.i18n.getMessage("doNotDisturb")),$("#lblAutoAllow").html(chrome.i18n.getMessage("autoAllowRequest"))}function showGuestRequestDialog(e,t){var n=chrome.i18n.getMessage("allowRequest")+"<br>"+t;document.getElementById("es_modal-guestRequest")&&(document.getElementById("es_modal-guestRequest").checked=e,void 0!==n&&$("#es_request_content").html(n))}function showWaitHostDialog(e){document.getElementById("es_modal-waitHost")&&(document.getElementById("es_modal-waitHost").checked=e)}function showDeniedRequestDialog(e,t){document.getElementById("es_modal-denied-request")&&(document.getElementById("es_modal-denied-request").checked=e),$("#es_denied-request-message").html(t)}function HostControlInit(){$("#es_waitHost-message").html(chrome.i18n.getMessage("waitPermission"))}function HomePageInit(){"ESHAREPRO"===chrome.runtime.getManifest().product.toUpperCase()?$("#search-img").addClass("viewHide"):($("#search-pro-img").addClass("viewHide"),$("#search-miraip-img").addClass("viewHide"),$("#directLink").addClass("viewHide")),$("#txtVersion").html(chrome.runtime.getManifest().version.toString())}function connectIP(){var e=document.getElementById("AddressCode").value.toString();window.ESHARECMCLIENT.Util.ValidateIPaddress(e)?($("div#ipaddressDialog").modal("hide"),$("#inputWarningMsg").hide(),ShowDeviceList(e)):window.ESHARECMCLIENT.Util.ValidateMiracode(e)?($("div#ipaddressDialog").modal("hide"),$("#inputWarningMsg").hide(),ShowDeviceList(window.ESHARECMCLIENT.Util.MiracodeToIP(e))):($("div#ipaddressDialog").modal("hide"),$("#inputWarningMsg").hide(),ShowDeviceList(e,!0))}window.tvMirrorWindowCreated=!1,UIActionProc.found=function(e){OnReceiverFound(e.data)},UIActionProc.disconnectedByDevice=function(e){$(".list_table").empty(),$("div#pleaseWaitDialog").modal("hide"),$("div#connectDialog").modal("hide"),$("div#castcodeDialog").removeClass("allow"),e.error&&showMessageDlg("Device disconnected."),$("#dongleName").html(""),ShowDeviceList(),$("#main_container").addClass("offline_mode")},UIActionProc.emirroring_disconnected=function(e){$("div#castcodeDialog").removeClass("allow")},UIActionProc.wait=function(e){$("div#pleaseWaitDialog").modal()},UIActionProc.error=function(e){$("div#pleaseWaitDialog").modal("hide"),$("div#connectDialog").modal("hide"),showMessageDlg(e.error)},UIActionProc.savePrefer=function(e){e.MAC&&(ES_HOST_MAC=e.MAC),currentDevice=e.device,$("div#connectDialog").modal("hide"),$("div#AskSavePrefer").modal()},UIActionProc.connectedToProjector=function(e){e.MAC&&(ES_HOST_MAC=e.MAC),OnConnectedToProjector(e.device)},UIActionProc.onGetService=function(e){e.services&&updateUIbyService(e.services)},UIActionProc.onNotifyPos=function(e){ES_SPLIT_COUNT=e.count,ES_SPLIT_POSITION=e.position,OnNotifyPosition(ES_SPLIT_COUNT,ES_SPLIT_POSITION),chrome.runtime.sendMessage({action:"happy"})},UIActionProc.waitHost=function(e){showWaitHostDialog(e.isOpen)},UIActionProc.deniedRequest=function(e){showWaitHostDialog(!1),showDeniedRequestDialog(!0,e.msg)},UIActionProc.cancelRequest=function(e){showGuestRequestDialog(!1,"")},UIActionProc.guestRequest=function(e){showGuestRequestDialog(!0,e.ip.toString())},UIActionProc.allowMirror=function(e){setBtnMirror(!0)},UIActionProc.endMirror=function(e){setBtnMirror(!1)},UIActionProc.goMediaStreaming=function(e){ShowMedia()},UIActionProc.goSetting=function(e){ShowSetting()},UIActionProc.goWeb=function(e){ShowWebview()},UIActionProc.goMain=function(e){ShowMainpage()},UIActionProc.playVisJS=function(e){playVisJS(e.src,e.title,e.image,e.type)},UIActionProc.showProgress=function(e){$("div#pleaseWaitDialog").modal()},UIActionProc.hideProgress=function(e){$("div#pleaseWaitDialog").modal("hide")},UIActionProc.onStartMirror=function(e){var t=JSON.parse(e.device),n={action:e.callback,media:e.media,pos:e.pos,count:e.count};t.passcode&&""!==t.passcode&&!$("div#castcodeDialog").hasClass("allow")?($("#btnCastcodeConfirm").unbind("click"),$("#btnCastcodeConfirm").click((function(){confirmCastCode(n)})),$("div#castcodeDialog").modal()):chrome.runtime.sendMessage(n)},UIActionProc.prepareToGetImg=function(e){chrome.runtime.sendMessage({tvMirrorAciton:"readyToGetImgData",hubIp:e.hubIp})},UIActionProc.roleChanged=function(e){if(currentDevice&&currentDevice.Name){var t=("host"===e.role?"(Host) ":"(Guest) ")+currentDevice.Name;$("#dongleName").html(t)}},UIActionProc.updateEzBoardButton=function(e){"host"===e.role?$("#btn_magicboard").removeClass("guest"):void 0!==e.role&&$("#btn_magicboard").addClass("guest"),"enable"!==e.show&&void 0!==e.show?$("#btn_magicboard").addClass("guest.disable"):$("#btn_magicboard").removeClass("guest.disable")},UIActionProc.networkDisconnect=function(e){document.getElementsByClassName("list_table")[0].lastChild},chrome.runtime.onMessage.addListener((function(e,t,n){e.uiAction&&UIActionProc[e.uiAction]&&UIActionProc[e.uiAction](e)})),window.addEventListener("resize",(function(e){doWebviewLayout()})),window.addEventListener("load",(function(e){chrome.app.window.get("ESClientMain")&&(chrome.app.window.get("ESClientMain").onClosed.addListener((function(){ES_GA_Usetime&&ES_GA_Usetime.send(),chrome.runtime.sendMessage({action:"appClose"})})),chrome.app.window.get("ESClientMain").onMaximized.addListener((function(){doWebviewLayout()})),chrome.app.window.get("ESClientMain").onRestored.addListener((function(){doWebviewLayout()})),"ESHAREPRO"===chrome.runtime.getManifest().product.toUpperCase()&&$(".imgLogo").addClass("Pro"),MainPageInit(),PreferenceInit(),HostControlInit(),HomePageInit(),ShowDeviceList(),$(".imgLogo").attr("data-toggle","tooltop"),$(".imgLogo").attr("title",chrome.runtime.getManifest().version.toString()),$("[data-toggle='tooltip']").tooltip(),chrome.runtime.sendMessage({action:"readDeviceName"}))}));var hexcase=0,b64pad="";function hex_md5(e){return rstr2hex(rstr_md5(str2rstr_utf8(e)))}function b64_md5(e){return rstr2b64(rstr_md5(str2rstr_utf8(e)))}function any_md5(e,t){return rstr2any(rstr_md5(str2rstr_utf8(e)),t)}function hex_hmac_md5(e,t){return rstr2hex(rstr_hmac_md5(str2rstr_utf8(e),str2rstr_utf8(t)))}function b64_hmac_md5(e,t){return rstr2b64(rstr_hmac_md5(str2rstr_utf8(e),str2rstr_utf8(t)))}function any_hmac_md5(e,t,n){return rstr2any(rstr_hmac_md5(str2rstr_utf8(e),str2rstr_utf8(t)),n)}function md5_vm_test(){return"ab4cde67b72503267809ea8e52074cb4"==hex_md5("012345678901\tbind").toLowerCase()}function rstr_md5(e){return binl2rstr(binl_md5(rstr2binl(e),8*e.length))}function rstr_hmac_md5(e,t){var n=rstr2binl(e);n.length>16&&(n=binl_md5(n,8*e.length));for(var o=Array(16),i=Array(16),r=0;r<16;r++)o[r]=909522486^n[r],i[r]=1549556828^n[r];var s=binl_md5(o.concat(rstr2binl(t)),512+8*t.length);return binl2rstr(binl_md5(i.concat(s),640))}function rstr2hex(e){for(var t,n=hexcase?"0123456789ABCDEF":"0123456789abcdef",o="",i=0;i<e.length;i++)t=e.charCodeAt(i),o+=n.charAt(t>>>4&15)+n.charAt(15&t);return o}function rstr2b64(e){for(var t="",n=e.length,o=0;o<n;o+=3)for(var i=e.charCodeAt(o)<<16|(o+1<n?e.charCodeAt(o+1)<<8:0)|(o+2<n?e.charCodeAt(o+2):0),r=0;r<4;r++)8*o+6*r>8*e.length?t+=b64pad:t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(i>>>6*(3-r)&63);return t}function rstr2any(e,t){var n,o,i,r,s,a=t.length,c=Array(Math.ceil(e.length/2));for(n=0;n<c.length;n++)c[n]=e.charCodeAt(2*n)<<8|e.charCodeAt(2*n+1);var d=Math.ceil(8*e.length/(Math.log(t.length)/Math.log(2))),l=Array(d);for(o=0;o<d;o++){for(s=Array(),r=0,n=0;n<c.length;n++)r=(r<<16)+c[n],r-=(i=Math.floor(r/a))*a,(s.length>0||i>0)&&(s[s.length]=i);l[o]=r,c=s}var m="";for(n=l.length-1;n>=0;n--)m+=t.charAt(l[n]);return m}function str2rstr_utf8(e){for(var t,n,o="",i=-1;++i<e.length;)t=e.charCodeAt(i),n=i+1<e.length?e.charCodeAt(i+1):0,55296<=t&&t<=56319&&56320<=n&&n<=57343&&(t=65536+((1023&t)<<10)+(1023&n),i++),t<=127?o+=String.fromCharCode(t):t<=2047?o+=String.fromCharCode(192|t>>>6&31,128|63&t):t<=65535?o+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):t<=2097151&&(o+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return o}function str2rstr_utf16le(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(255&e.charCodeAt(n),e.charCodeAt(n)>>>8&255);return t}function str2rstr_utf16be(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e.charCodeAt(n)>>>8&255,255&e.charCodeAt(n));return t}function rstr2binl(e){for(var t=Array(e.length>>2),n=0;n<t.length;n++)t[n]=0;for(var o=0;o<8*e.length;o+=8)t[o>>5]|=(255&e.charCodeAt(o/8))<<o%32;return t}function binl2rstr(e){for(var t="",n=0;n<32*e.length;n+=8)t+=String.fromCharCode(e[n>>5]>>>n%32&255);return t}function binl_md5(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var n=1732584193,o=-271733879,i=-1732584194,r=271733878,s=0;s<e.length;s+=16){var a=n,c=o,d=i,l=r;n=md5_ff(n,o,i,r,e[s+0],7,-680876936),r=md5_ff(r,n,o,i,e[s+1],12,-389564586),i=md5_ff(i,r,n,o,e[s+2],17,606105819),o=md5_ff(o,i,r,n,e[s+3],22,-1044525330),n=md5_ff(n,o,i,r,e[s+4],7,-176418897),r=md5_ff(r,n,o,i,e[s+5],12,1200080426),i=md5_ff(i,r,n,o,e[s+6],17,-1473231341),o=md5_ff(o,i,r,n,e[s+7],22,-45705983),n=md5_ff(n,o,i,r,e[s+8],7,1770035416),r=md5_ff(r,n,o,i,e[s+9],12,-1958414417),i=md5_ff(i,r,n,o,e[s+10],17,-42063),o=md5_ff(o,i,r,n,e[s+11],22,-1990404162),n=md5_ff(n,o,i,r,e[s+12],7,1804603682),r=md5_ff(r,n,o,i,e[s+13],12,-40341101),i=md5_ff(i,r,n,o,e[s+14],17,-1502002290),n=md5_gg(n,o=md5_ff(o,i,r,n,e[s+15],22,1236535329),i,r,e[s+1],5,-165796510),r=md5_gg(r,n,o,i,e[s+6],9,-1069501632),i=md5_gg(i,r,n,o,e[s+11],14,643717713),o=md5_gg(o,i,r,n,e[s+0],20,-373897302),n=md5_gg(n,o,i,r,e[s+5],5,-701558691),r=md5_gg(r,n,o,i,e[s+10],9,38016083),i=md5_gg(i,r,n,o,e[s+15],14,-660478335),o=md5_gg(o,i,r,n,e[s+4],20,-405537848),n=md5_gg(n,o,i,r,e[s+9],5,568446438),r=md5_gg(r,n,o,i,e[s+14],9,-1019803690),i=md5_gg(i,r,n,o,e[s+3],14,-187363961),o=md5_gg(o,i,r,n,e[s+8],20,1163531501),n=md5_gg(n,o,i,r,e[s+13],5,-1444681467),r=md5_gg(r,n,o,i,e[s+2],9,-51403784),i=md5_gg(i,r,n,o,e[s+7],14,1735328473),n=md5_hh(n,o=md5_gg(o,i,r,n,e[s+12],20,-1926607734),i,r,e[s+5],4,-378558),r=md5_hh(r,n,o,i,e[s+8],11,-2022574463),i=md5_hh(i,r,n,o,e[s+11],16,1839030562),o=md5_hh(o,i,r,n,e[s+14],23,-35309556),n=md5_hh(n,o,i,r,e[s+1],4,-1530992060),r=md5_hh(r,n,o,i,e[s+4],11,1272893353),i=md5_hh(i,r,n,o,e[s+7],16,-155497632),o=md5_hh(o,i,r,n,e[s+10],23,-1094730640),n=md5_hh(n,o,i,r,e[s+13],4,681279174),r=md5_hh(r,n,o,i,e[s+0],11,-358537222),i=md5_hh(i,r,n,o,e[s+3],16,-722521979),o=md5_hh(o,i,r,n,e[s+6],23,76029189),n=md5_hh(n,o,i,r,e[s+9],4,-640364487),r=md5_hh(r,n,o,i,e[s+12],11,-421815835),i=md5_hh(i,r,n,o,e[s+15],16,530742520),n=md5_ii(n,o=md5_hh(o,i,r,n,e[s+2],23,-995338651),i,r,e[s+0],6,-198630844),r=md5_ii(r,n,o,i,e[s+7],10,1126891415),i=md5_ii(i,r,n,o,e[s+14],15,-1416354905),o=md5_ii(o,i,r,n,e[s+5],21,-57434055),n=md5_ii(n,o,i,r,e[s+12],6,1700485571),r=md5_ii(r,n,o,i,e[s+3],10,-1894986606),i=md5_ii(i,r,n,o,e[s+10],15,-1051523),o=md5_ii(o,i,r,n,e[s+1],21,-2054922799),n=md5_ii(n,o,i,r,e[s+8],6,1873313359),r=md5_ii(r,n,o,i,e[s+15],10,-30611744),i=md5_ii(i,r,n,o,e[s+6],15,-1560198380),o=md5_ii(o,i,r,n,e[s+13],21,1309151649),n=md5_ii(n,o,i,r,e[s+4],6,-145523070),r=md5_ii(r,n,o,i,e[s+11],10,-1120210379),i=md5_ii(i,r,n,o,e[s+2],15,718787259),o=md5_ii(o,i,r,n,e[s+9],21,-343485551),n=safe_add(n,a),o=safe_add(o,c),i=safe_add(i,d),r=safe_add(r,l)}return Array(n,o,i,r)}function md5_cmn(e,t,n,o,i,r){return safe_add(bit_rol(safe_add(safe_add(t,e),safe_add(o,r)),i),n)}function md5_ff(e,t,n,o,i,r,s){return md5_cmn(t&n|~t&o,e,t,i,r,s)}function md5_gg(e,t,n,o,i,r,s){return md5_cmn(t&o|n&~o,e,t,i,r,s)}function md5_hh(e,t,n,o,i,r,s){return md5_cmn(t^n^o,e,t,i,r,s)}function md5_ii(e,t,n,o,i,r,s){return md5_cmn(n^(t|~o),e,t,i,r,s)}function safe_add(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function bit_rol(e,t){return e<<t|e>>>32-t}